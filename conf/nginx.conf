events {
  worker_connections 1024;
}

http {
    upstream staging_patronale_life_ws {
        server staging-patronale-life.mgx.io:19021;
    }
    
    server {
        listen         443 ssl;
        server_name api.patronale-life.be;

        ssl on;
        ssl_certificate      /opt/ssl/patronale_ssl.crt;
        ssl_certificate_key  /opt/ssl/patronale_ssl.key;
        ssl_protocols        SSLv3 TLSv1 TLSv1.1 TLSv1.2;
        ssl_ciphers RC4:HIGH:!aNULL:!MD5;
        ssl_prefer_server_ciphers on;
        ssl_session_cache    shared:SSL:10m;
        ssl_session_timeout  10m;
        
        gzip on;
        keepalive_timeout    70;

        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log debug;

        location / {
                proxy_set_header X-Real-IP $remote_addr;
                proxy_set_header X-Scheme $scheme;
                proxy_set_header Host $http_host;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_redirect off;
                proxy_pass_header Server;
                proxy_pass http://staging_patronale_life_ws;
        }

    }
}
