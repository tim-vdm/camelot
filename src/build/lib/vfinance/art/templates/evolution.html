{% extends 'vfinance_base_internal.html' %}
{% set internal_document = true %}

{% block content %}
<h2>Account {{account.package.name}} {{account.id}}</h2>

<h4>Subscribers</h4>
{% for subscriber in subscribers %}
   {{subscriber.name}}<br/>
{% endfor %}

<h4>Evolution</h4>
<table width="100%">
    <tr>
      <td align="left">Value on {{options.from_document_date}}</td>
      <td align="left"></td>
      <td align="right">{{from_value|currency}}</td>
    </tr>
    {% for movement in account_movements %}
        {% if movement.amount != 0 %}
            <tr>
                <td align="left">{{movement.movement_type}}</td>
                <td align="left">{{movement.reference}}</td>
                <td align="right">{{movement.amount|currency}}</td>
            </tr>
        {% endif %}
    {% endfor %}
    <tr>
      <td align="left">Value on {{options.thru_document_date}}</td>
      <td align="left"></td>
      <td align="right">{{thru_value|currency}}</td>
    </tr>
</table>

<h4>Fund Value on {{options.thru_document_date}}</h4>
<table width="100%">
    <tr>
      <td align="left">Name</td>
      <td align="right">Date</td>
      <td align="right">Amount</td>
      <td align="right">Quantity</td>
    </tr>
{% if uninvested %}
    <tr>
      <td align="left">Uninvested</td>
      <td align="right">{{options.thru_document_date}}</td>
      <td align="right">{{uninvested|currency}}</td>
      <td align="right"></td>
    </tr>
{% endif %}
{% for entry in value_overview %}
    <tr>
      <td align="left">{{entry.fund}}</td>
      <td align="right">{{entry.doc_date}}</td>
      <td align="right">{{entry.amount|currency}}</td>
      <td align="right">{{entry.quantity}}</td>
    </tr>
{% endfor %}
</table>

<h4>Fund evolution</h4>

{% for security_data in securities %}
<h3> {{security_data.security.name}} </h3>

<table width="100%">
    <tr>
      <td align="left">Security quotation</td>
      <td align="right">{{security_data.security_quotation|currency}}</td>
    </tr>
    <tr>
      <td align="left">Risk deduction</td>
      <td align="right">{{security_data.risk_deduction|currency}}</td>
    </tr>
</table>

<table width="100%">
    <tr>
      <td align="left">Date</td>
      <td align="left">Nav Date</td>
      <td align="left">Description</td>
      <td align="right">Amount</td>
      <td align="right">Quantity</td>
    </tr>
    {% for movement in security_data.movements %}
            <tr>
                <td align="left">{{movement.doc_date}}</td>
                <td align="left">{{movement.nav_date}}</td>
                <td align="left">{{movement.movement_type}}</td>
                <td align="right">{{movement.amount|currency}}</td>
                <td align="right">{{movement.quantity}}</td>
            </tr>
    {% endfor %}
</table>
{% endfor %}

<h4>State</h4>


{% for premium_schedule_state in premium_schedule_states %}

    <h5> {{premium_schedule_state.premium_schedule}} </h5>
    
    <table width="100%">
        <tr>
          <td align="left">Schedule</td>
          <td align="right">Capital</td>
          <td align="right">Interest</td>
          <td align="right">Additional interest</td>
          <td align="right">Profit sharing</td>
          <td align="right">Value</td>
        </tr>
        <tr>
            <td align="left">{{premium_schedule_state.premium_schedule}}</td>
            <td align="right">{{premium_schedule_state.capital|currency}}</td>
            <td align="right">{{premium_schedule_state.interest|currency}}</td>
            <td align="right">{{premium_schedule_state.additional_interest|currency}}</td>
            <td align="right">{{premium_schedule_state.profit_sharing|currency}}</td>
            <td align="right">{{premium_schedule_state.value|currency}}</td>
        </tr>
    </table>
    
    <table width="100%">
        <tr>
            <td align="left">Date</td>
            <td align="left">Description</td>
            <td align="right">Amount</td>
        </tr>
        
        {% for movement in premium_schedule_state.movements %}
        <tr>
            <td align="left">{{movement.doc_date}}</td>
            <td align="left">
               {{movement.movement_type}} <br/>
               {% for feature in movement.features %}
                  {{ feature.described_by }} : {{ feature.value }} (from {{feature.apply_from_date}} thru {{feature.apply_thru_date }})<br/>
               {% endfor %}
            </td>
            <td align="right">{{movement.amount|currency}}</td>
        </tr>
        {% endfor %}
        
    </table>
    
{% endfor %}

{% endblock %}