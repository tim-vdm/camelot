{% extends "insurance/vfinance_insurance_base.html" %}
{% block doc_version %}CIP{% endblock %}

{% block html_head %}
<style type="text/css">
.label {
	font-weight: bold;
}
</style>
{% endblock %}

{% block content %}
    {{ pageheader(first=true) }}
    <p class="h1">{{_('premium proposal')|capitalize}}(*) {{_('credit insurance')}} {{proposal.agreement_package}}</p>
    <br>
    <p class="h1">Code: {{code}}</p>
    <hr>
    {% if proposal.agreement_broker_relation %}
    <p class="h2">{{_('intermediary')|upper}}</p>
    <br>
    <table width="50%">
        <tr>
            <td class="label">{{_('name')|capitalize}}</td>
            <td>{{proposal.agreement_broker_relation.name}}</td>
            <td class="label">FSMA:</td>
            <td>{% for official_number in proposal.agreement_broker_relation.rechtspersoon.official_numbers -%}
                    {%- if official_number.type.lower() == 'cbfa' -%}
                        {{ official_number.number }}
                        {%- if not loop.last -%}, {%- endif -%}
                    {%- endif -%}
                {%- endfor -%}</td>
        </tr>
        <tr>
            <td class="label">{{_('address')|capitalize}}</td>
            <td colspan="3">{{proposal.agreement_broker_relation.street}}</td>
        </tr>
        <tr>
            <td class="label">{{_('zipcode')|capitalize}}</td>
            <td>{{proposal.agreement_broker_relation.postcode}}</td>
            <td class="label">{{_('city')|capitalize}}</td>
            <td>{{proposal.agreement_broker_relation.city}}</td>
        </tr>
        <tr>
            <td class="label">{{_('phone')|capitalize}}</td>
            <td>{{proposal.agreement_broker_relation.telefoon}}</td>
            <td class="label">{{_('email')|capitalize}}</td>
            <td>{{proposal.agreement_broker_relation.email}}</td>
        </tr>
    </table>
    <br>
    <br>
	{% endif %}
    <p class="h2">{{_('simulation')|upper}} (*)</p>
    <p class="h3">{{_('basic data')|capitalize}} {{_('mortgage credit')}} {{_('and')}} {{_('coverage')}}</p>
    <br>
	{% set loan_loan_amount = proposal.loan_loan_amount %}
	{% set loan_type_of_payments = proposal.loan_type_of_payments %}
	{% set loan_interest_rate = proposal.loan_interest_rate %}
	{% set loan_number_of_months = proposal.loan_number_of_months %}
	{% set loan_withdrawal_period = 0 %}
	{% set loan_payment_interval = 12/proposal.loan_payment_interval %}
	{% set loan_repayment_start = proposal.loan_from_date %}
	{% set loan_delay_repayments = 0 %}
	{% set loan_periodic_interest = proposal.periodic_interest%}
	{% include 'includes/mortgage_table_info.html' %}

    <table width="100%">
		<tr>
            <td class="label" width="25%">{{_('insured percentage')|capitalize}}</td>
			<td>{{proposal.coverage_coverage_limit|currency}} %</td>
		</tr>
        <tr>
            <td class="label" width="25%">{{_('insured capital')|capitalize}} (***)</td>
            <td>
				{%- for ps_data in premiums_data -%}
                    {%- for coverage_data in ps_data.coverages -%}
                        {{ coverage_data.insured_capitals.0.insured_capital|currency }}
                        {%- if ps_data.coverages|length > 1 %} ({{coverage_data.reference_number}}){% endif -%}
                        {%- if not loop.last %}, {% endif -%}
                	{%- endfor -%}
                {%- endfor %} €	({{_('see attached table')|capitalize}} "{{_('progress of coverage')|capitalize}}")</td>
        </tr>
    </table>
    {#<p class="h3">{{_('personal data')|capitalize}} {{_('mortgage credit')}}</p>#}
    <table width="100%">
        <tr>
            <td width="30%"><p class="h3">{{_('personal data')|capitalize}}</p></td>
            <td width="40%"><p class="h3">{{_('insured party')|capitalize}}{% if proposal.two_insured_parties %} 1{% endif %}</p></td>
            <td width="40%"><p class="h3">{% if proposal.two_insured_parties %}{{_('insured party')|capitalize}} 2{% else %}&nbsp;{% endif %}</p></td>
        </tr>
        <tr>
            <td class="label">{{_('name')|capitalize}}</td>
            <td>{{ proposal.insured_party__1__lastname }}</td>
            <td>{% if proposal.two_insured_parties %}{{ proposal.insured_party__2__lastname }}{% else %}&nbsp;{% endif %}</td>
        </tr>
        <tr>
            <td class="label">{{_('first name')|capitalize}}</td>
            <td>{{ proposal.insured_party__1__firstname }}</td>
            <td>{% if proposal.two_insured_parties %}{{ proposal.insured_party__2__firstname }}{% else %}&nbsp;{% endif %}</td>
        </tr>
        <tr>
            <td class="label">{{_('gender')|capitalize}}</td>
            <td>{{ proposal.insured_party__1__gender|translate }}</td>
            <td>{% if proposal.two_insured_parties %}{{ proposal.insured_party__2__gender|translate }}{% else %}&nbsp;{% endif %}</td>
        </tr>
        <tr>
            <td class="label">{{_('date of birth')|capitalize}}</td>
            <td>{{ proposal.insured_party__1__birthdate|date }}</td>
            <td>{% if proposal.two_insured_parties %}{{ proposal.insured_party__2__birthdate|date }}{% else %}&nbsp;{% endif %}</td>
        </tr>
        <tr>
            <td class="label">{{_('smoker')|capitalize}}</td>
            <td>{% if proposal.insured_party__1__smoker %}{{_('yes')|capitalize}}{% else %}{{_('no')|capitalize}}{% endif %}</td>
            <td>{% if proposal.two_insured_parties %}{% if proposal.insured_party__2__smoker %}{{_('yes')|capitalize}}{% else %}{{_('no')|capitalize}}{% endif %}{% else %}&nbsp;{% endif %}</td>
        </tr>
        <tr><td colspan="3">&nbsp;</td></tr>
    </table>
    <p class="h3">{{_('premium')|capitalize}} {{_('credit insurance')}}</p>
    <table width="100%">
        <tr>
            <td width="25%" class="label">{{_('payment premium')|capitalize}}</td>
            <td width="25%">{{ _(proposal.period_type) }}</td>
            <td width="25%" class="label">{{_('number of payments')|capitalize}}</td>
            <td width="25%">{% for ps_data in premiums_data -%}
                                {{ps_data.number_of_payments}}{% if premiums_data|length > 1 %} ({{ps_data.rank}}){% endif -%}
                                {%- if not loop.last %}, {% endif -%}
                            {%- endfor %}</td>
        </tr>
        <tr>
            <td class="label">{{_('insurance period')|capitalize}}</td>
            <td colspan="3">{% for ps_data in premiums_data -%}
                    {%- for coverage_data in ps_data.coverages -%}
                        {{ coverage_data.from_date|date }} {{_('up to and including')}} {{ coverage_data.thru_date|date }}
                        {%- if ps_data.coverages|length > 1 %} ({{coverage_data.reference_number}}){% endif -%}
                        {%- if not loop.last %}, {% endif -%}
                    {%- endfor -%}
                {%- endfor %}</td>
            {# 
            <td class="label">{{_('payment period')|capitalize}}</td>
            <td>{% for ps_data in premiums_data -%}
                    {{ps_data.payment_duration_months}} {{_('months')}}{% if premiums_data|length > 1 %} ({{ps_data.rank}}){% endif -%}
                    {%- if not loop.last %}, {% endif -%}
                {%- endfor %}</td>
            #}
        </tr>
        <tr>
            <td class="label">{{_('start date')|capitalize}}</td>
            <td colspan="3">{{proposal.premium_from_date|date }}</td>
        </tr>
    </table>
    <br><hr><br>
    <table width="50%">
        <tr>
            <td><p class="h4">{{_('premium')|capitalize}}(*)</p></td>
            <td><p class="h4">{{_('net premium')|capitalize}}</p></td>
            <td><p class="h4">{{_('taxes')|capitalize}}</p></td>
        </tr>
        <tr>
            <td>{% for ps_data in premiums_data -%}
                    {{ps_data.premium_schedule.premium_amount|currency}} €{% if premiums_data|length > 1 %} ({{ps_data.rank}}){% endif -%}
                    {%- if not loop.last %}, {% endif -%}
                {%- endfor %}</td>
            <td>{% for ps_data in premiums_data -%}
                    {{ps_data.amounts.premium_minus_taxes|currency}} €{% if premiums_data|length > 1 %} ({{ps_data.rank}}){% endif -%}
                    {%- if not loop.last %}, {% endif -%}
                {%- endfor %}</td>
            <td>{% for ps_data in premiums_data -%}
                    {{ps_data.amounts.taxation|currency}} €{% if premiums_data|length > 1 %} ({{ps_data.rank}}){% endif -%}
                    {%- if not loop.last %}, {% endif -%}
                {%- endfor %}</td>
        </tr>
    </table>
    <br><hr><br>
    <p>
        <em>
            (*) {{_('This personal premium proposition is valid until 30 days after emission and is informative, on the basis of the current data and does not commit neither the candidate insured party, nor Patronale Life NV. The premium is given with reservation of acceptance of the dossier by Patronale Life NV and with reservation of potential additional premiums/exclusion. This premium proposition is based on normal health of the insured party/parties. To conclude closure of the Policy, a declaration of health needs to be completed by the Insured Party. From this declaration of health it will become apparent if a potential augmentation of the premium is owed because of a hightened medical risk. To sign this premium, Patronale needs to receive the following documents: fully completed and signed Request Form and declaration of health (referenced to on the request form); a copy of the valid identity card of the insured party/parties (with print of address data).')}}
        </em>
        <br>
        <em>(**) {{_('Annual Percentage Rate')}}</em>
		<br>
		<em>(***) {{_('This capital decreases as planned in the attached table, starting q month after starting date.')}}</em>
    </p>   
    {{ pageheader() }}
    <p class="h3">{{ _('progress of coverage')|capitalize }}</p>
    <p>{{_('The insured capital at decease of the insured party decreases on a monthly basis according to the data above. The insured capital in the table below is displayed per year (12 months from starting date).')}}</p>
    <br>
    {% for ps_data in premiums_data %}
    <table width="50%">
        {% if premiums_data|length > 1 %}
            <tr><th colspan="2">{{_('premium schedule')|capitalize}}: {{ps_data.rank}}</th></tr>
        {% endif %}
        {% for coverage_data in ps_data.coverages -%}
            {% if ps_data.coverages|length > 1 %}
                <tr><th colspan="2">{{_('coverage')|capitalize}}: {{coverage_data.reference_number}}</th></tr>
            {% endif %}
            <tr>
                <th>
                    <p class="h4" style="font-size: 12px">{{_('year')}}<hr></p>
                </th>
                <th>
                    <p class="h4" style="font-size: 12px">{{_('insured capital')}}<hr></p>
                </th>
            </tr>
            {%- for insured_capital in coverage_data.insured_capitals -%}
                <tr>
                    <td align="center">{{ insured_capital.from_date|date }}</td>
                    <td alignn="right">€ {{insured_capital.insured_capital|currency}}</td>
                </tr>
            {%- endfor -%}
        {%- endfor %}
    </table>
    {% endfor %}
{% endblock %}
